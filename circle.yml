machine:
  node:
    version: 4.2.6
    
dependencies:
  cache_directories:
    - ~/.meteor
  override:
    - meteor || curl https://install.meteor.com | /bin/sh
    - meteor npm install --save babel-runtime
    - cd app; meteor update --patch
    - npm install --production
    
test:
  override:
#    - cd app; meteor --settings settings_demo.json
    - cd app; meteor add dispatch:mocha
    - cd app; meteor test --once --driver-package dispatch:mocha

general:
  artifacts:
    - "validate.json" # a single file, relative to the build directory
    - "package.json"
    
deployment:
  prod:
    branch: cicd
    commands:
    - echo install
#      - aws s3 sync site s3://demo2.d1g.nl --delete --acl public-read
